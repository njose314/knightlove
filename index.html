<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Crown & The Heart</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400;1,600&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #030303; 
            --text-main: #e5e5e5; 
            --gold: #c6a87c; 
            --gold-dim: rgba(198, 168, 124, 0.5);
            --crimson: #8a0a1b; 
        }
        
        body { 
            background-color: var(--bg); 
            color: var(--text-main); 
            font-family: 'Cormorant Garamond', serif; 
            overflow: hidden; 
            -webkit-tap-highlight-color: transparent;
        }

        .font-royal { font-family: 'Cinzel', serif; }
        
        /* Layout Utilities */
        .h-dvh { height: 100dvh; } 
        .hidden-screen { display: none !important; }
        
        /* Animations */
        .fade-enter { animation: fadeIn 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards; opacity: 0; transform: translateY(10px); }
        .delay-1 { animation-delay: 0.2s; }
        .delay-2 { animation-delay: 0.6s; }
        
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }

        /* Custom Scrollbar */
        .custom-scroll { overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-track { background: #0a0a0a; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }

        /* Button Styling */
        .choice-btn {
            background: linear-gradient(90deg, rgba(198, 168, 124, 0.05) 0%, transparent 100%);
            border-left: 2px solid var(--gold-dim);
            transition: all 0.3s ease;
        }
        .choice-btn:active { background: rgba(198, 168, 124, 0.15); border-color: var(--gold); transform: translateX(5px); }

        /* Wax Seal */
        #waxSeal { transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); box-shadow: 0 10px 40px rgba(0,0,0,0.6); }
        .pressing #waxSeal { transform: scale(0.9) rotate(2deg); filter: brightness(0.9); }
    </style>
</head>
<body>

    <section id="screen1" class="h-dvh w-full flex flex-col justify-center items-center p-8 text-center relative bg-[url('https://www.transparenttextures.com/patterns/stardust.png')] bg-fixed">
        <div class="absolute inset-0 bg-gradient-to-b from-black/20 via-black/80 to-black pointer-events-none"></div>
        
        <div class="z-10 relative space-y-8 fade-enter">
            <div class="border-y border-[#c6a87c]/30 py-8 px-2">
                <p class="font-royal text-[10px] uppercase tracking-[0.4em] text-[#c6a87c] mb-4">Propose Day Special</p>
                <h1 class="font-royal text-5xl md:text-6xl text-[#e5e5e5] tracking-tight leading-tight">
                    The Crown <br>
                    <span class="text-3xl italic font-serif text-[#c6a87c] opacity-80">&</span><br>
                    The Heart
                </h1>
            </div>
            
            <p class="italic text-lg text-gray-400 font-serif opacity-80 fade-enter delay-1">
                "A Knight without a name.<br>A Queen without a choice."
            </p>

            <button onclick="startGame()" class="mt-8 px-10 py-3 border border-[#c6a87c]/40 text-[#c6a87c] font-royal text-xs uppercase tracking-[0.25em] hover:bg-[#c6a87c] hover:text-black transition-all duration-500 fade-enter delay-2">
                Open The Book
            </button>
        </div>
    </section>

    <section id="screen2" class="h-dvh w-full hidden-screen flex flex-col bg-[#050505] relative">
        <header class="h-16 shrink-0 border-b border-white/5 flex items-center justify-center bg-[#050505] z-20">
            <span class="font-royal text-[9px] uppercase tracking-[0.3em] text-[#c6a87c] opacity-60">The Chronicle</span>
        </header>

        <div id="scrollContainer" class="flex-grow custom-scroll relative">
            <div class="max-w-xl mx-auto min-h-full flex flex-col p-8 pb-12">
                
                <div id="storyContent" class="space-y-6 text-xl md:text-2xl leading-relaxed text-gray-300 font-serif mb-12"></div>

                <div id="choiceContainer" class="mt-auto space-y-4 pt-8 border-t border-white/5 opacity-0 transition-opacity duration-700"></div>
            </div>
        </div>
    </section>

    <section id="screen3" class="h-dvh w-full hidden-screen flex flex-col justify-center items-center p-8 text-center bg-black relative overflow-hidden">
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,#3d000a,transparent_70%)] opacity-30 pointer-events-none"></div>
        
        <div class="z-10 space-y-6 mb-16 fade-enter">
            <h2 class="font-royal text-2xl md:text-3xl text-[#c6a87c]">The Covenant</h2>
            <p class="font-serif text-xl text-gray-400 italic max-w-md mx-auto leading-relaxed">
                "I renounce the crown. I choose the man."
            </p>
        </div>

        <div id="sealContainer" class="relative group cursor-pointer z-10 select-none fade-enter delay-1">
            <div id="waxSeal" class="w-56 h-56 rounded-full bg-gradient-to-br from-[#8a0a1b] to-[#4a0208] flex items-center justify-center relative border-[6px] border-[#2e0105] shadow-2xl">
                <div class="w-44 h-44 rounded-full border border-[#b8233a]/30 flex flex-col items-center justify-center opacity-90 p-4">
                    <span class="font-royal text-sm text-[#3d020a] drop-shadow-md uppercase tracking-[0.2em] mb-1">Two Souls</span>
                    <div class="h-[1px] w-12 bg-[#3d020a] opacity-50 my-1"></div>
                    <span class="font-royal text-sm text-[#3d020a] drop-shadow-md uppercase tracking-[0.2em] mt-1">Now One</span>
                </div>
                <div class="absolute top-8 left-12 w-16 h-8 bg-white opacity-5 rounded-full blur-xl"></div>
            </div>
        </div>

        <div class="mt-12 z-10 fade-enter delay-2">
            <p id="sealInstruction" class="font-royal text-[10px] uppercase tracking-[0.3em] text-[#c6a87c] opacity-60 animate-pulse">
                Press & Hold to Seal
            </p>
        </div>
    </section>

    <section id="screen4" class="h-dvh w-full hidden-screen flex flex-col justify-center items-center p-6 bg-[#030303] relative">
        <div class="border border-[#c6a87c]/20 bg-[#080808] p-10 max-w-md w-full text-center shadow-2xl relative fade-enter">
            <span class="absolute top-2 left-2 text-[#c6a87c] opacity-40 text-xl font-serif">⌜</span>
            <span class="absolute top-2 right-2 text-[#c6a87c] opacity-40 text-xl font-serif">⌝</span>
            <span class="absolute bottom-2 left-2 text-[#c6a87c] opacity-40 text-xl font-serif">⌞</span>
            <span class="absolute bottom-2 right-2 text-[#c6a87c] opacity-40 text-xl font-serif">⌟</span>

            <h1 id="endTitle" class="font-royal text-2xl text-[#c6a87c] mb-6 leading-tight"></h1>
            <p id="endDesc" class="font-serif text-lg text-gray-300 leading-relaxed mb-8 opacity-90"></p>
            
            <div class="h-px w-16 bg-[#c6a87c]/30 mx-auto mb-6"></div>
            
            <p id="endNote" class="font-royal text-[9px] uppercase tracking-[0.2em] text-gray-500 mb-8"></p>
            
            <button onclick="resetGame()" class="text-[#c6a87c] text-xs font-royal uppercase tracking-widest border-b border-[#c6a87c]/30 pb-1 hover:text-white hover:border-white transition-colors">
                Rewrite Destiny
            </button>
        </div>
    </section>

    <script>
        // --- NARRATIVE DATABASE ---
        const story = {
            start: {
                text: [
                    "The year is 1426. The Kingdom of Veridia is drowning in a storm.",
                    "The Great Hall is filled with music and laughter, celebrating your betrothal to a Prince you do not love—a man with a crown of gold and a heart of ice.",
                    "But your eyes are not on the Prince. They are fixed on the shadowed figure standing near the heavy oak doors.",
                    "The Knight. Your father's sworn sword. A man of no title, no land, and no right to look at you the way he does.",
                    "He turns to leave, his cape swirling around him, stepping out into the relentless rain."
                ],
                choices: [
                    { label: "Slip away to the gardens to stop him.", next: "garden_01" },
                    { label: "Stay. A Queen does not chase shadows.", next: "duty_01" },
                    { label: "Send a page with a secret letter.", next: "letter_01" }
                ]
            },

            // --- PATH: THE GARDEN ---
            garden_01: {
                text: [
                    "You slip through the servants' passage, silk skirts trailing in the mud. The rain hits your skin like needles.",
                    "You find him near the stables, mounting his black steed. He freezes as you approach.",
                    "'My Lady?' His voice is rough, like stone grinding on stone. 'You cannot be here. If the Duke sees us, it is my head on a pike.'"
                ],
                choices: [
                    { label: "Reach for his hand. 'I do not care.'", next: "garden_touch" },
                    { label: "Beg him to take you away.", next: "garden_run" },
                    { label: "Hesitate. 'I just wanted to say goodbye.'", next: "end_regret" }
                ]
            },
            garden_touch: {
                text: [
                    "You reach out. Your trembling fingers brush his leather gauntlet. He flinches, then succumbs, covering your hand with his.",
                    "He looks at you with a treasonous intimacy.",
                    "'This world was not made for us,' he says. 'I am a sword to be used and discarded. You are a jewel to be sold for an alliance. We can never be.'"
                ],
                choices: [
                    { label: "'Then let us break this world.'", next: "garden_kiss" },
                    { label: "Pull back in fear.", next: "end_fear" }
                ]
            },
            garden_run: {
                text: [
                    "'Take me away,' you plead. 'Anywhere but here.'",
                    "The Knight looks at you with agonizing love. 'I have no home to offer you, My Queen. Only a saddle and a sword. I love you too much to make you a beggar.'"
                ],
                choices: [
                    { label: "'I would rather be a beggar with you.'", next: "garden_kiss" },
                    { label: "Realize he is right and let him go.", next: "end_regret" }
                ]
            },
            garden_kiss: {
                text: [
                    "The distance vanishes. He pulls you close, his armor cold against your chest, his kiss burning with a desperate heat.",
                    "When you pull apart, his eyes are steel. 'If we do this, there is no going back. We ride for the Blackwood ruins tonight. We will be hunted.'",
                    "'Are you sure, my Queen?'"
                ],
                choices: [
                    { label: "Swear your life to him.", next: "ROYAL_SEAL" },
                    { label: "Falster at the thought of being hunted.", next: "end_coward" }
                ]
            },

            // --- PATH: THE LETTER ---
            letter_01: {
                text: [
                    "You scribble a hasty note: 'My heart goes with you.' You pay a page boy to run it to him.",
                    "From the balcony, you watch him read it in the rain. His shoulders slump. He looks up at your window once—a look of utter devastation—before riding into the dark."
                ],
                choices: [
                    { label: "Run to the stables immediately.", next: "chase_horse" },
                    { label: "Turn back to the banquet.", next: "end_duty" }
                ]
            },
            chase_horse: {
                text: [
                    "You run until your lungs burn. You reach the courtyard, mud staining your dress.",
                    "Empty. Only the sound of fading hoofbeats in the rain.",
                    "You were five minutes too late."
                ],
                choices: [
                    { label: "Collapse and weep.", next: "end_missed" }
                ]
            },

            // --- PATH: DUTY ---
            duty_01: {
                text: [
                    "You straighten your spine. You are a daughter of Veridia. You do not chase dreams.",
                    "You turn back to the Prince. He smiles cruelly. 'Finally focused, my dear?'",
                    "The heavy doors shut, sealing the Knight out, and sealing you in a cage of gold."
                ],
                choices: [
                    { label: "Accept your fate.", next: "end_duty" }
                ]
            },

            // --- ENDINGS ---
            end_regret: {
                title: "Ending: The Ghost of What If",
                desc: "The Knight rode away that night. You married the Prince. You lived a life of luxury, but you never smiled truly again. The ghost of the man you loved haunted your halls forever.",
                note: "Regret is a poison. Reweave your fate."
            },
            end_fear: {
                title: "Ending: The Golden Cage",
                desc: "Fear held you back. You stayed safe in your castle, wondering where he went, until your heart turned to dust.",
                note: "Comfort is the enemy of passion. Try again."
            },
            end_coward: {
                title: "Ending: A Moment's Hesitation",
                desc: "You pulled away at the last second. The guards found you. The Knight was arrested for touching a noblewoman. You saved his life by banishing him, destroying his soul.",
                note: "Hesitation kills destiny. Try again."
            },
            end_duty: {
                title: "Ending: The Cold Queen",
                desc: "You became a powerful Queen. Respected, feared, and utterly alone. You died surrounded by gold, whispering a name no one remembered.",
                note: "Power cannot comfort a lonely soul. Try again."
            },
            end_missed: {
                title: "Ending: Too Late",
                desc: "Timing is everything. He died in a foreign war believing you never cared. Fate is cruel to those who wait.",
                note: "Do not wait. Act. Try again."
            },
            
            // --- HAPPY ENDING ---
            happy_ending: {
                title: "The True Ending: Freedom",
                desc: "You sealed the vow. You rode into the night, leaving the crown behind. <br><br>History calls you the 'Lost Queen,' but you were never lost. You lived by the sea with him, growing old in a house filled with warmth.<br><br><b>Two souls, finally one.</b>",
                note: "You found the only path that matters."
            }
        };

        // --- GAME ENGINE ---
        const scrollContainer = document.getElementById('scrollContainer');
        const contentDiv = document.getElementById('storyContent');
        const choiceDiv = document.getElementById('choiceContainer');

        function startGame() {
            document.getElementById('screen1').classList.add('hidden-screen');
            document.getElementById('screen2').classList.remove('hidden-screen');
            loadNode('start');
        }

        function loadNode(nodeId) {
            if (nodeId === 'ROYAL_SEAL') return showSealScreen();
            if (nodeId.startsWith('end_')) return showEnding(story[nodeId]);

            const data = story[nodeId];

            // Fade Out
            contentDiv.style.opacity = '0';
            choiceDiv.style.opacity = '0';

            setTimeout(() => {
                scrollContainer.scrollTop = 0;
                contentDiv.innerHTML = '';
                
                // Text Rendering
                data.text.forEach((para, i) => {
                    const p = document.createElement('p');
                    p.className = `fade-enter delay-${Math.min(i, 3)}`;
                    p.style.animationDelay = `${i * 0.15}s`;
                    p.innerText = para;
                    contentDiv.appendChild(p);
                });

                // Choice Rendering
                choiceDiv.innerHTML = '';
                data.choices.forEach((choice) => {
                    const btn = document.createElement('button');
                    btn.className = "choice-btn w-full py-5 px-6 text-left group flex items-center";
                    btn.innerHTML = `
                        <span class="font-royal text-[#c6a87c] mr-4 text-sm opacity-60 group-hover:opacity-100 transition-opacity">◇</span>
                        <span class="font-serif text-lg text-gray-300 group-hover:text-white transition-colors">${choice.label}</span>
                    `;
                    btn.onclick = () => {
                        if (navigator.vibrate) navigator.vibrate(10);
                        loadNode(choice.next);
                    };
                    choiceDiv.appendChild(btn);
                });

                // Fade In
                contentDiv.style.opacity = '1';
                setTimeout(() => choiceDiv.style.opacity = '1', 600);
            }, 300);
        }

        // --- SEAL LOGIC ---
        function showSealScreen() {
            document.getElementById('screen2').classList.add('hidden-screen');
            document.getElementById('screen3').classList.remove('hidden-screen');
            
            const seal = document.getElementById('sealContainer');
            const wax = document.getElementById('waxSeal');
            const instr = document.getElementById('sealInstruction');
            let holdTimer;
            let isHolding = false;

            const startHold = (e) => {
                if(e.cancelable) e.preventDefault();
                if(isHolding) return;
                isHolding = true;

                seal.classList.add('pressing');
                instr.innerText = "Imprinting...";
                instr.classList.remove('opacity-60', 'animate-pulse');
                instr.classList.add('text-white');

                holdTimer = setTimeout(() => {
                    if (navigator.vibrate) navigator.vibrate([50, 50, 200]);
                    instr.innerText = "Vow Accepted";
                    instr.classList.add('text-[#8a0a1b]');
                    wax.style.transform = "scale(1)";
                    setTimeout(() => showEnding(story.happy_ending), 1500);
                }, 2000);
            };

            const endHold = () => {
                if(!isHolding) return;
                isHolding = false;
                clearTimeout(holdTimer);
                seal.classList.remove('pressing');
                instr.innerText = "Press & Hold to Seal";
                instr.classList.add('opacity-60', 'animate-pulse');
                instr.classList.remove('text-white');
            };

            seal.addEventListener('touchstart', startHold);
            seal.addEventListener('touchend', endHold);
            seal.addEventListener('mousedown', startHold);
            seal.addEventListener('mouseup', endHold);
            seal.addEventListener('mouseleave', endHold);
        }

        // --- ENDING LOGIC ---
        function showEnding(data) {
            document.getElementById('screen2').classList.add('hidden-screen');
            document.getElementById('screen3').classList.add('hidden-screen');
            document.getElementById('screen4').classList.remove('hidden-screen');
            
            document.getElementById('endTitle').innerHTML = data.title;
            document.getElementById('endDesc').innerHTML = data.desc;
            document.getElementById('endNote').innerText = data.note;
        }

        function resetGame() {
            document.getElementById('screen4').classList.add('hidden-screen');
            startGame();
        }
    </script>
</body>
</html>
